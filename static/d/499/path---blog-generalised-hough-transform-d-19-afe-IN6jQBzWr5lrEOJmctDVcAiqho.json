{"data":{"markdownRemark":{"frontmatter":{"title":"Generalized Hough Transform","date":"2019-07-01","tags":["Hough Transform","computer vision","image analysis"]},"html":"<p>Have you ever wondered how lines or shapes can be detected from images? Well, before the times of Machine Learning and deep networks where the neural network somehow extracts the features and makes sense of it, a more mathematical approach was used. Actually, I don't know why I am using the past tense, because this method is still widely used in image processing and computer vision to detect features, objects, or shapes of any type. This is the method that we will explore today, and it is called the \"Generalized Hough Transform.\"</p>\n<p>Ok actually, \"Generalized Hough Transform\" kind of sound intimidating. The name sounds like Fourier Transform or Laplace Transform and when the word \"transform\" is attached, I get a mini heart attack thinking about the conversion tables and properties that needs to be memorized. HOWEVER, I can assure you that the \"Generalized Hough Transform\" is essentially just template matching and the algorithm really doesn't involve anything complex.</p>\n<p>The Hough Transform is normally used to find lines in images. The main idea is to transform points in the image space into lines in the \"transformed\" space. The intersection of many lines (a point) in the transformed space defines a lines in the image space. I will not go over this specific case, but it will help you understand the \"Generalized Hough Transform\" better if you understand the specific line case. I am going to assume that you understand the specific line case for the rest of the post.</p>\n<h2>Purpose</h2>\n<p>Let's say I have an image. Below is an image of me on my plane back to the US from Switzerland as I am writing this post on the flight.</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 621px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 114.3317230273752%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAXABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAEDBAUG/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgAB/9oADAMBAAIQAxAAAAGtGLLrWoYYqJ2jD//EABoQAQEBAQADAAAAAAAAAAAAAAECAxEEEiH/2gAIAQEAAQUCrss+R6WPSaFsJrLdc8wSj6TPP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ASn/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAADAAEFAAAAAAAAAAAAAAAAARECEiExQWH/2gAIAQEABj8CSewtNSpR4Z+xjlYqOrseLOD/xAAbEAEAAgMBAQAAAAAAAAAAAAABACERMVFBYf/aAAgBAQABPyHFhy3k8jfFB0wAGm4bj6bsVkAFfYkq5WojwwFUbqpzvbn/2gAMAwEAAgADAAAAEEMYA//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8Qxe2Qtk7f/8QAFxEBAQEBAAAAAAAAAAAAAAAAAREAEP/aAAgBAgEBPxCgTXITn//EAB4QAQACAgIDAQAAAAAAAAAAAAEAESExUWFBccHw/9oACAEBAAE/ELIlDYstxAHFh1zhvh7mpxB6YtOgjbaa71MlAo2tD7cRFURvDuZdJGFn7iKKKjCeIUhYaC3P/9k='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"original\"\n        title=\"\"\n        src=\"/static/d937f0edd467182c0cb5074ea076b83e/b84d7/original.jpg\"\n        srcset=\"/static/d937f0edd467182c0cb5074ea076b83e/4272c/original.jpg 188w,\n/static/d937f0edd467182c0cb5074ea076b83e/1459e/original.jpg 375w,\n/static/d937f0edd467182c0cb5074ea076b83e/b84d7/original.jpg 621w\"\n        sizes=\"(max-width: 621px) 100vw, 621px\"\n      />\n  </span></p>\n<p>I also have a template image. The template is the shape that I want to find in the above image. This template for this example is an upper case E from my EPFL cap.</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 48px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 129.16666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAc2E0pec5T/FRBqVF//EACAQAAICAgAHAAAAAAAAAAAAAAIDAQQAERASExQhIjH/2gAIAQEAAQUCWomYNZcTY1DaU+pQiC85WjkSHbpKwXUbvgPz/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAIBAAAQMDBQEAAAAAAAAAAAAAAQACERIiMQMQICFBUf/aAAgBAQAGPwK0K98n4o08JyJLpJ2l3vaqqkoubjh//8QAGxABAAMBAQEBAAAAAAAAAAAAAQARQSFhMVH/2gAIAQEAAT8hVwNfkoHgGoFUc52JVg8jynN9iX/JUoHtkCA4HaIElK8mQ3P/2gAMAwEAAgADAAAAELgTfv/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8Qb2GkIf/EAB0QAQEAAwEAAwEAAAAAAAAAAAERACExQWFxgbH/2gAIAQEAAT8QpKJFoMIajYOO/OJ6iJwH3eJW6rp6m/4Y1AQD0/mUAUDxMMB1C+gS4BB3buXsAxTQgC6sMCpAgLwx6+sKiC30z//Z'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"template\"\n        title=\"\"\n        src=\"/static/2509b4f45fd620160a56bf179cce49f4/12a70/template.jpg\"\n        srcset=\"/static/2509b4f45fd620160a56bf179cce49f4/12a70/template.jpg 48w\"\n        sizes=\"(max-width: 48px) 100vw, 48px\"\n      />\n  </span></p>\n<p>Now I want to know the location of the uppercase E in the picture of me at the airport. You are probably thinking that this task is super easy. It is obviously the first letter on the cap in the upper left corner of the image. However, this task might not be this easy for a computer.</p>\n<h2>algorithm</h2>\n<ul>\n<li>Step 1: preprocess both images (find edges and their orientation)</li>\n<li>Step 2: define a mathematical model for the template shape (r-table)</li>\n<li>Step 3: find (accumulate) all the possible locations of template on image</li>\n<li>Step 4: find most frequent location</li>\n</ul>\n<h3>Step 1: preprocess both images</h3>\n<p>A key feature that defines a template or shape is the contour or the edges. Therefore, the computer needs to work with the edges. An edge in an image can be found through computing the gradient. You can think about the gradient as a vector with a magnitude and direction. The magnitude of the gradient tells us how \"sharp\" the edge is, so a greater magnitude corresponds to an \"edgier\" pixel. The direction of the gradient tells us the edge orientation. So for example, does an edge pixel corresponds to a horizontal edge or vertical or maybe a 45 degrees edge?</p>\n<p>Since we are working with edges, we have to first convert the template and target image to both greyscale images. Then we can use the \"Canny\" edge detection algorithm to find the edges. In order to find the edge orientations, we can use the Sobel filters to first compute the gradient in x and y directions at each edge pixel. Then we can find the orientation by computing the arctan of dx and dy, so that each pixel in the edge orientation map is between [0,2<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">π</span></span></span></span>]</p>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"generalised-hough-transform"}}