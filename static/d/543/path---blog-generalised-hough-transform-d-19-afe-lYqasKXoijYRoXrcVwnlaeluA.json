{"data":{"markdownRemark":{"frontmatter":{"title":"Generalized Hough Transform","date":"2019-07-01","tags":["Hough Transform","computer vision","image analysis"]},"html":"<p>Have you ever wondered how lines or shapes can be detected from images? Well, before the times of Machine Learning and deep networks where the neural network somehow extracts the features and makes sense of it, a more mathematical approach was used. Actually, I don't know why I am using the past tense, because this method is still widely used in image processing and computer vision to detect features, objects, or shapes of any type. This is the method that we will explore today, and it is called the \"Generalized Hough Transform.\"</p>\n<p>Ok actually, \"Generalized Hough Transform\" kind of sound intimidating. The name sounds like Fourier Transform or Laplace Transform and when the word \"transform\" is attached, I get a mini heart attack thinking about the conversion tables and properties that needs to be memorized. HOWEVER, I can assure you that the \"Generalized Hough Transform\" is essentially just template matching and the algorithm really doesn't involve anything complex.</p>\n<p>The Hough Transform is normally used to find lines in images. The main idea is to transform points in the image space into lines in the \"transformed\" space. The intersection of many lines (a point) in the transformed space defines a lines in the image space. I will not go over this specific case, but it will help you understand the \"Generalized Hough Transform\" better if you understand the specific line case.</p>\n<h2>What's the point?</h2>\n<p>Let's say I have an image (target image). Below is an image of me on my flight back to the US from Switzerland. What's a better way to spend the 7 hours than to write about the Hough Transform? :)</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 621px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 114.3317230273752%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAXABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAEDBAUG/8QAFgEBAQEAAAAAAAAAAAAAAAAAAgAB/9oADAMBAAIQAxAAAAGtGLLrWoYYqJ2jD//EABoQAQEBAQADAAAAAAAAAAAAAAECAxEEEiH/2gAIAQEAAQUCrss+R6WPSaFsJrLdc8wSj6TPP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ASn/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAcEAADAAEFAAAAAAAAAAAAAAAAARECEiExQWH/2gAIAQEABj8CSewtNSpR4Z+xjlYqOrseLOD/xAAbEAEAAgMBAQAAAAAAAAAAAAABACERMVFBYf/aAAgBAQABPyHFhy3k8jfFB0wAGm4bj6bsVkAFfYkq5WojwwFUbqpzvbn/2gAMAwEAAgADAAAAEEMYA//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8Qxe2Qtk7f/8QAFxEBAQEBAAAAAAAAAAAAAAAAAREAEP/aAAgBAgEBPxCgTXITn//EAB4QAQACAgIDAQAAAAAAAAAAAAEAESExUWFBccHw/9oACAEBAAE/ELIlDYstxAHFh1zhvh7mpxB6YtOgjbaa71MlAo2tD7cRFURvDuZdJGFn7iKKKjCeIUhYaC3P/9k='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"original\"\n        title=\"\"\n        src=\"/static/d937f0edd467182c0cb5074ea076b83e/b84d7/original.jpg\"\n        srcset=\"/static/d937f0edd467182c0cb5074ea076b83e/4272c/original.jpg 188w,\n/static/d937f0edd467182c0cb5074ea076b83e/1459e/original.jpg 375w,\n/static/d937f0edd467182c0cb5074ea076b83e/b84d7/original.jpg 621w\"\n        sizes=\"(max-width: 621px) 100vw, 621px\"\n      />\n  </span></p>\n<p>I also have a template image. The template is the shape that I want to find in the above image. This template for this example is an upper case E from my cap.</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 48px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 129.16666666666669%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAUBAgME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAc2E0pec5T/FRBqVF//EACAQAAICAgAHAAAAAAAAAAAAAAIDAQQAERASExQhIjH/2gAIAQEAAQUCWomYNZcTY1DaU+pQiC85WjkSHbpKwXUbvgPz/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAIBAAAQMDBQEAAAAAAAAAAAAAAQACERIiMQMQICFBUf/aAAgBAQAGPwK0K98n4o08JyJLpJ2l3vaqqkoubjh//8QAGxABAAMBAQEBAAAAAAAAAAAAAQARQSFhMVH/2gAIAQEAAT8hVwNfkoHgGoFUc52JVg8jynN9iX/JUoHtkCA4HaIElK8mQ3P/2gAMAwEAAgADAAAAELgTfv/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABcRAAMBAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8Qb2GkIf/EAB0QAQEAAwEAAwEAAAAAAAAAAAERACExQWFxgbH/2gAIAQEAAT8QpKJFoMIajYOO/OJ6iJwH3eJW6rp6m/4Y1AQD0/mUAUDxMMB1C+gS4BB3buXsAxTQgC6sMCpAgLwx6+sKiC30z//Z'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"template\"\n        title=\"\"\n        src=\"/static/2509b4f45fd620160a56bf179cce49f4/12a70/template.jpg\"\n        srcset=\"/static/2509b4f45fd620160a56bf179cce49f4/12a70/template.jpg 48w\"\n        sizes=\"(max-width: 48px) 100vw, 48px\"\n      />\n  </span></p>\n<p>Now I want to know the location (x-y coordinate) of the uppercase E in the target image. You are probably thinking that this task is super easy. It is obviously the first letter on the cap in the upper left corner of the image. However, this task might not be this easy for a computer, so this is when the generalized Hough Transform comes in!</p>\n<h2>Algorithm</h2>\n<ul>\n<li>Step 1: preprocess both images (find edges and their orientation)</li>\n<li>Step 2: specification of template shape (compute r-table)</li>\n<li>Step 3: find (accumulate) all the possible locations of template on image and find most frequent center</li>\n</ul>\n<h3>Step 1: preprocess both images</h3>\n<p>A key feature that defines a template or shape is the contour or the edges, so it makes sense that the computer needs to find the edges in order to make sense of a shape. An edge in an image can be found through computing the gradient. You can think about the gradient as a vector with a magnitude and direction. The magnitude of the gradient tells us how \"sharp\" the edge is, so a greater magnitude corresponds to an \"edgier\" pixel. The direction of the gradient tells us the edge orientation since the edge orientation is perpendicular to the gradient direction. So for example, does an edge pixel corresponds to a horizontal edge <strong>--</strong> or vertical <strong>|</strong> or maybe a 45 degrees edge <strong>/</strong>?</p>\n<ul>\n<li>\n<p><strong>|</strong></p>\n</li>\n<li>\n<p><strong>-</strong></p>\n</li>\n<li>\n<p><strong>/</strong></p>\n</li>\n<li>\n<p><strong>\\</strong></p>\n</li>\n</ul>\n<p>Since we are working with edges, we have to first convert the template and target image to both greyscale images. Then we can use the \"Canny\" edge detection algorithm to find the edges. In order to find the edge orientations, we can use the Sobel filters to first compute the gradient in x and y directions at each edge pixel. Then we can find the orientation by computing the arctan of dx and dy, so that each pixel in the edge orientation map is between [0, 2<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">π</span></span></span></span>].</p>\n<p>So what does an orientation of an edge mean?</p>\n<pre><code>def find_edge_orientation(image):\n\n    dy = sobel(image, axis=0)\n    dx = sobel(image, axis=1)\n    edge_orientation = np.arctan2(dy, dx) + np.pi  # +np.pi ->  grad orientation is in the rage [0,2*pi]\n\n    return edge_orientation\n</code></pre>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.406797116374875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAVJ2TUqHQ//EABgQAQEBAQEAAAAAAAAAAAAAAAMCBAES/9oACAEBAAEFAtKpzQqp5w1VDecqus5d4Ryc/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEC/9oACAECAQE/AeXGXW//xAAdEAACAgIDAQAAAAAAAAAAAAABAgARIVEDEiIx/9oACAEBAAY/AnAdqvc4vbZTcPZicwllyYtr8EpRQn//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhMUH/2gAIAQEAAT8hBSHAsgKrrHW6xQRvq34S/wC9G2AnjGvIl3l9n//aAAwDAQACAAMAAAAQ1B//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxBn/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EC0YkS//xAAbEAEAAwEBAQEAAAAAAAAAAAABABEhMWFRgf/aAAgBAQABPxCvnkCBRzciMENGzo732D8pC1XDYaV10Vv4w5KBnVZa77DhI0Wdo+vk/9k='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"set1\"\n        title=\"\"\n        src=\"/static/01d092ba4060042bae135f39ea2156a6/a66cd/set1.jpg\"\n        srcset=\"/static/01d092ba4060042bae135f39ea2156a6/4272c/set1.jpg 188w,\n/static/01d092ba4060042bae135f39ea2156a6/1459e/set1.jpg 375w,\n/static/01d092ba4060042bae135f39ea2156a6/a66cd/set1.jpg 750w,\n/static/01d092ba4060042bae135f39ea2156a6/c0626/set1.jpg 1125w,\n/static/01d092ba4060042bae135f39ea2156a6/45751/set1.jpg 1500w,\n/static/01d092ba4060042bae135f39ea2156a6/a79ba/set1.jpg 1942w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n      />\n  </span>\n<span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62.98969072164948%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHPptdQweD/AP/EABoQAAMAAwEAAAAAAAAAAAAAAAECAwQFEhP/2gAIAQEAAQUCNadWq/eExaJ14JfDDmEvFP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAMQL/2gAIAQIBAT8B5Q2dv//EACEQAAEBBwUAAAAAAAAAAAAAAAEAAhESISIjQTEyUWGR/9oACAEBAAY/Ajcb9Qqa2jKqJM8o3DPpAx6DhQvev//EABwQAQEBAAEFAAAAAAAAAAAAAAERACExQVFhgf/aAAgBAQABPyHj/Ue7EMOvBeMkULMaIYdiED43tfbJv//aAAwDAQACAAMAAAAQLA//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxBn/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EGIxWX//xAAdEAEBAAICAwEAAAAAAAAAAAABEQAxIWFRccHR/9oACAEBAAE/EJuokcW3jfWE1gBgW1fOA99Cro49YTaCpL9wohNh0C76wnCp2G0/M//Z'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"set2\"\n        title=\"\"\n        src=\"/static/5be78617d36ec5d77bf70e0bbb360a59/a66cd/set2.jpg\"\n        srcset=\"/static/5be78617d36ec5d77bf70e0bbb360a59/4272c/set2.jpg 188w,\n/static/5be78617d36ec5d77bf70e0bbb360a59/1459e/set2.jpg 375w,\n/static/5be78617d36ec5d77bf70e0bbb360a59/a66cd/set2.jpg 750w,\n/static/5be78617d36ec5d77bf70e0bbb360a59/c0626/set2.jpg 1125w,\n/static/5be78617d36ec5d77bf70e0bbb360a59/45751/set2.jpg 1500w,\n/static/5be78617d36ec5d77bf70e0bbb360a59/7d560/set2.jpg 1940w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n      />\n  </span></p>\n<h3>Step 2: specification of template shape (r-table)</h3>\n<p>Now that we have the edge map and the edge orientation map of both the target and template images, we need to use this information to define the shape of the template. The main idea here is that we want to eventually differentiate the specific template that we want to find in the target image with other possible shapes in the target image. Therefore, we need to parametrize the template that defines the shape so that it would be unique enough to not be confused with other potential shapes. A good way to parametrize this template is to use the vector from each edge pixel to an arbitrary \"center\" point of the template. The vector is the information we need, which has a magnitude <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span></span></span></span> and direction <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span></span></span></span>, both which can be calculated from the edge map of the template. Finally, we should organize each pixel edge's information by its orientation, which we have from the template edge orientation map.</p>\n<p>In other words, we are computing the r-table. As the name suggest, it is a table in which each row corresponds to an edge orientation. Each entry in the table represent an edge pixel location <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> with respect to a center point. A single row in the table can have multiple such entries. When inserting a new entry  <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> representing an edge pixel, we first find the orientation of that edge pixel. Then the orientation is used to find the row in the table and  <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> is appended to the entries in that particular row. Since the r-table's index is discrete, you can choose how many types of edge orientations to store since the values of the orientation map is between 0 and 2<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">π</span></span></span></span>, so we can break that into (row_count) values shown in the python code below.</p>\n<ul>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi><mo>=</mo><msqrt><mrow><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>x</mi></msub><mo>−</mo><mi>x</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>c</mi><mi>y</mi></msub><mo>−</mo><mi>y</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">r = \\sqrt{(c_x - x)^2 + (c_y - y)^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.32305399999999995em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.916946em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathdefault\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathdefault\">x</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathdefault\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.740108em;\"><span style=\"top:-2.9890000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.8769460000000002em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119c34,79.3,68.167,\n158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120c340,-704.7,510.7,-1060.3,512,-1067\nc4.7,-7.3,11,-11,19,-11H40000v40H1012.3s-271.3,567,-271.3,567c-38.7,80.7,-84,\n175,-136,283c-52,108,-89.167,185.3,-111.5,232c-22.3,46.7,-33.8,70.3,-34.5,71\nc-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1s-109,-253,-109,-253c-72.7,-168,-109.3,\n-252,-110,-252c-10.7,8,-22,16.7,-34,26c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26\ns76,-59,76,-59s76,-60,76,-60z M1001 80H40000v40H1012z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32305399999999995em;\"><span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>α</mi><mo>=</mo><mi>t</mi><mi>a</mi><msup><mi>n</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy=\"false\">(</mo><mfrac><mrow><msub><mi>c</mi><mi>y</mi></msub><mo>−</mo><mi>y</mi></mrow><mrow><msub><mi>c</mi><mi>x</mi></msub><mo>−</mo><mi>x</mi></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha = tan^{-1}({c_y - y \\over c_x - x})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.360751em;vertical-align:-0.44509999999999994em;\"></span><span class=\"mord mathdefault\">t</span><span class=\"mord mathdefault\">a</span><span class=\"mord\"><span class=\"mord mathdefault\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.915651em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16454285714285719em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathdefault mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.50732em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.16454285714285716em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2818857142857143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.44509999999999994em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n</li>\n</ul>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 62.98969072164948%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAMEBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEC/9oADAMBAAIQAxAAAAHPptdQweD/AP/EABoQAAMAAwEAAAAAAAAAAAAAAAECAwQFEhP/2gAIAQEAAQUCNadWq/eExaJ14JfDDmEvFP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAMQL/2gAIAQIBAT8B5Q2dv//EACEQAAEBBwUAAAAAAAAAAAAAAAEAAhESISIjQTEyUWGR/9oACAEBAAY/Ajcb9Qqa2jKqJM8o3DPpAx6DhQvev//EABsQAQEBAAIDAAAAAAAAAAAAAAERACExUWGB/9oACAEBAAE/IeP9jOWIYdeC8ZIoWY0Qw7EIHxva+2Tf/9oADAMBAAIAAwAAABBsD//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/EGf/xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQIBAT8QYjFZf//EAB0QAQACAgIDAAAAAAAAAAAAAAEAESExUWFxwdH/2gAIAQEAAT8QqokqYtuDPUBhADAt1eYD32Erox4hNsFSr7hRCbR0C99QnCs7htXyf//Z'); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"example\"\n        title=\"\"\n        src=\"/static/53c77955bd2dedb281969e64aa877237/a66cd/example.jpg\"\n        srcset=\"/static/53c77955bd2dedb281969e64aa877237/4272c/example.jpg 188w,\n/static/53c77955bd2dedb281969e64aa877237/1459e/example.jpg 375w,\n/static/53c77955bd2dedb281969e64aa877237/a66cd/example.jpg 750w,\n/static/53c77955bd2dedb281969e64aa877237/c0626/example.jpg 1125w,\n/static/53c77955bd2dedb281969e64aa877237/45751/example.jpg 1500w,\n/static/53c77955bd2dedb281969e64aa877237/7d560/example.jpg 1940w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n      />\n  </span></p>\n<p>In the image above, the red point indicates the center. The blue point indicate an edge pixel. If you look at the same pixel in the edge orientation map, the value at that edge pixel is zero. This is because the edge pixel's orientation is \"vertical\". So for each blue point (edge pixel), there is a <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span></span></span></span> value that defines the red vector, and the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> is the information stored in the r-table.</p>\n<pre><code>def build_r_table(template, center_point, row_count):\n\n    edges = canny(template)\n    orientations = find_edge_orientation(edges)\n    r_table = [[] for i in range(row_count)]\n\n    for (i, j), value in np.ndenumerate(edges):\n        if value:\n\n            r = np.sqrt((center_point[0] - i) ** 2 + (center_point[1] - j) ** 2) # compute r\n            alpha = np.arctan2(i - center_point[0], j - center_point[1]) + np.pi # compute alpha\n\n            index = int(row_count * orientations[i, j] / (2 * np.pi)) # compute row index in the table\n\n            r_table[index].append((r, alpha)) # append the value to R-table\n\n    return r_table\n</code></pre>\n<h3>Step 3: find (accumulate) all the possible locations of template on image</h3>\n<p>Now this step is the actual step that will find the location of the template. The main idea is that we will look at all the edge pixels in the target image. Each edge pixel will have an edge orientation. Now all we have to do is to look up that specific orientation in the r-table. From that specific row, we will see one or multiple <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> pairs. Each <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> will tell us a \"candidate center point\". This means that each <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span> will contribute to one \"vote\" to the candidate center point. The candidate center point is easily calculated since we have the edge pixel coordinate <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span> and we have a magnitude and direction indicated by <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">(</mo><mi>r</mi><mo separator=\"true\">,</mo><mi>α</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(r,\\alpha)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span><span class=\"mclose\">)</span></span></span></span>. Since we have a point and a vector, then we can find the candidate center by simply computing point + vector = center point. We are essentially reversing the <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding=\"application/x-tex\">r</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.02778em;\">r</span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.0037em;\">α</span></span></span></span> equation in step 2 to calculate the possible center locations.</p>\n<p><span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 750px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 55.68862275449102%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAABA//aAAwDAQACEAMQAAABit6LamR5J//EABkQAQADAQEAAAAAAAAAAAAAAAIBAwQSE//aAAgBAQABBQLRY40S35Z7O6lmpS8hyTBj/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFhEBAQEAAAAAAAAAAAAAAAAAAQIQ/9oACAECAQE/AboQDP/EAB0QAAICAgMBAAAAAAAAAAAAAAERAAIhMQMSUWH/2gAIAQEABj8Cur237ONWL6QE7hJpk/YlhKYn/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARMSFBUf/aAAgBAQABPyE5ADoFLxpNexcw439l7ZLW0AB5ejkqAon/2gAMAwEAAgADAAAAENMP/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQMBAT8QCf/EABYRAQEBAAAAAAAAAAAAAAAAAAEQIf/aAAgBAgEBPxAeNJ//xAAeEAEAAgIBBQAAAAAAAAAAAAABABExQXEhUWGBsf/aAAgBAQABPxAsvAIOOssiMO0HbvvzLF82KsbmI9gbfTKdIAaCoZ8sy3F1a/Z//9k='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"ret\"\n        title=\"\"\n        src=\"/static/b23b87b29b4ffd1599d17bb81b9a84d5/a66cd/ret.jpg\"\n        srcset=\"/static/b23b87b29b4ffd1599d17bb81b9a84d5/4272c/ret.jpg 188w,\n/static/b23b87b29b4ffd1599d17bb81b9a84d5/1459e/ret.jpg 375w,\n/static/b23b87b29b4ffd1599d17bb81b9a84d5/a66cd/ret.jpg 750w,\n/static/b23b87b29b4ffd1599d17bb81b9a84d5/c0626/ret.jpg 1125w,\n/static/b23b87b29b4ffd1599d17bb81b9a84d5/45751/ret.jpg 1500w,\n/static/b23b87b29b4ffd1599d17bb81b9a84d5/27a00/ret.jpg 2004w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n      />\n  </span></p>\n<pre><code>def compute_accumulator_array(target_I, r_table):\n\n  edges = canny(target_I)\n  orientations = grad_directions(edges)\n  accumulator = np.zeros(target_I.shape)\n  r_table_row_count = len(r_table)\n  vals = []\n  for (i, j), value in np.ndenumerate(edges):\n      if value: # edge check\n\n          index = int(r_table_row_count * orientations[i, j] / (2 * np.pi))\n\n          r_row = r_table[index]\n          for (r,alpha) in r_row:\n\n              # finding correct position to vote\n              accum_i = int(i + r * np.sin(alpha))  # y cordinate\n              accum_j = int(j + r * np.cos(alpha))  # x cordinate\n\n\n              # outofbound check and vote\n              if accum_i &#x3C; accumulator.shape[0] and accum_j &#x3C; accumulator.shape[1] and accum_i > 0 and accum_j > 0:\n                  accumulator[accum_i, accum_j] += 1\n\n  return accumulator\n</code></pre>\n<p>The accumulator has the same dimensions as the target image and it shows how many \"votes\" each location got. The lighter the pixel, the greater the value, which means the greater the possibility of the location being the actual center. Therefore, in order to find the best matched center location, we simply find the location with the greatest value in the accumulator map. You can see from the detection image indicated by the red dot is the best matched center for the template.</p>\n<h2>Conclusion + extensions</h2>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"generalised-hough-transform"}}